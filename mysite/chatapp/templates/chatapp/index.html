<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Django + ChatGPT Demo</title>
</head>
<body>
    <h2>ChatGPT Django ì—°ë™ í…ŒìŠ¤íŠ¸</h2>
    <textarea id="prompt" rows="4" cols="50">ì•ˆë…• ChatGPT!</textarea><br>
    <button id="sendBtn">ë³´ë‚´ê¸°</button>

    <h3>ì‘ë‹µ:</h3>
    <div id="result" style="border:1px solid #aaa; padding:10px; width:400px; min-height:80px;"></div>

    <script>
    document.getElementById('sendBtn').addEventListener('click', async () => {
        const prompt = document.getElementById('prompt').value;
        const result = document.getElementById('result');
        result.innerText = 'ìš”ì²­ ì¤‘...';

        try {
            const res = await fetch('/api/chat/', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({prompt})
            });

            const data = await res.json();
            if (res.ok) {
                result.innerText = data.response;

                // ğŸ”Š ChatGPT ì‘ë‹µì„ ìŒì„±ìœ¼ë¡œ ì½ê¸°
                speakText(data.response);

            } else {
                result.innerText = 'ì—ëŸ¬: ' + (data.error || JSON.stringify(data));
            }
        } catch (err) {
            result.innerText = 'ìš”ì²­ ì‹¤íŒ¨: ' + err.toString();
        }
    });

    // ğŸ¤ í…ìŠ¤íŠ¸ ìŒì„± ì¶œë ¥ í•¨ìˆ˜
    function speakText(text) {
        // ê¸°ì¡´ì— ë§í•˜ê³  ìˆë˜ ê²ƒ ì¤‘ë‹¨
        window.speechSynthesis.cancel();

        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'ko-KR';
        utterance.rate = 1.0;
        utterance.pitch = 1.0;

        window.speechSynthesis.speak(utterance);
    }
</script>

</body>
</html>
